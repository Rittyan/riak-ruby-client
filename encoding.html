<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'>
<meta content='IE=edge,chrome=1' http-equiv='X-UA-Compatible'>
<title>Character Encodings</title>
<link href="stylesheets/all.css" rel="stylesheet" type="text/css" />
<script src="javascripts/all.js" type="text/javascript"></script>
</head>
<body class='encoding'>
<header>
<nav>
<ul>
<li class='title'>riak-ruby-client</li>
<li><a href="./">Home</a></li>
<li><a href="kv.html">Key-Value</a></li>
<li><a href="yz.html">Search</a></li>
<li><a href="2i.html">Secondary Indexes</a></li>
<li><a href="crdt.html">CRDTs</a></li>
<li><a href="bucket_types.html">Bucket Types</a></li>
<li><a href="bucket_props.html">Bucket Properties</a></li>
<li><a href="encoding.html">Character Encodings</a></li>
<li><a href="rspecs.html">Testing</a></li>
<li class='space'><a href="install.html">Installation</a></li>
<li><a href="config.html">Configuration</a></li>
<li><a href="https://github.com/basho/riak-ruby-client">Source</a></li>
<li><a href="https://rubygems.org/gems/riak-client">Gem</a></li>
</ul>
</nav>

</header>
<div class='content'>
<h1 class='title'>Character Encodings</h1>
<div id='toc'></div>
<div id='yielded'><p>Ruby has flexible and powerful support for many different character encodings,
including UTF-8, Shift-JIS, and more. Not every sequence of bytes has a
character encoding though, and Ruby provides an &ldquo;ASCII-8BIT&rdquo; encoding (also
known as &ldquo;binary&rdquo;) that takes any sequence of bytes as valid.</p>
<pre class="highlight ruby"><code><span class="s2">"您好"</span><span class="p">.</span><span class="nf">encoding</span> <span class="c1">#=&gt; #&lt;Encoding:UTF-8&gt;</span>
<span class="s2">"您好"</span><span class="p">.</span><span class="nf">valid_encoding?</span> <span class="c1">#=&gt; true</span>
<span class="s2">"</span><span class="se">\xff\xff</span><span class="s2">"</span><span class="p">.</span><span class="nf">encoding</span> <span class="c1">#=&gt; #&lt;Encoding:UTF-8&gt;</span>
<span class="s2">"</span><span class="se">\xff\xff</span><span class="s2">"</span><span class="p">.</span><span class="nf">valid_encoding?</span> <span class="c1">#=&gt; false</span>
<span class="s2">"</span><span class="se">\xff\xff</span><span class="s2">"</span><span class="p">.</span><span class="nf">force_encoding</span><span class="p">(</span><span class="s1">'binary'</span><span class="p">).</span><span class="nf">valid_encoding?</span> <span class="c1">#=&gt; true</span>
</code></pre>

<p>For more information about encoding in Ruby, check out
<a href="http://ruby-doc.org/core-2.2.2/Encoding.html">the Ruby API documentation</a>, <a href="https://en.wikibooks.org/wiki/Ruby_Programming/Encoding">the Wikibooks page</a>, and
<a href="http://graysoftinc.com/character-encodings/understanding-m17n-multilingualization">James Edward Gray II&rsquo;s series about character encoding</a>.</p>

<p>Different parts of Riak have differing support for different byte sequences and
character encodings; the results of our testing with UTF-8 and binary strings
are below.</p>

<p>These findings were tested with Riak 2.1.1 using the <a href="https://github.com/basho-labs/riak-ruby-vagrant">riak-ruby-vagrant</a>
environment.</p>

<p>If you are curious about other character encodings, please let us know: we would
love to help you write better Riak-using software.</p>

<h2>Key-value</h2>

<p>Testing shows that key-value operations work with UTF-8 and arbitrary binary
strings.</p>

<h2>CRDTs</h2>

<p>Riak CRDTs have been tested successfully with UTF-8 and arbitrary binary
strings.</p>

<h2>Riak Search</h2>

<p>Riak Search (a.k.a. Yokozuna) is strict about characters. Not all valid
UTF-8 strings (and by extension, not all valid binary strings) are acceptable
names for indexes or schemas.</p>

<p>In addition, objects with keys or buckets that aren&rsquo;t ASCII 7-bit safe might
not be indexed by Riak Search.</p>
</div>
</div>
<footer>
Documentation generated at 2015-06-19 22:25:54 UTC from repo version 9f988cd9ce680beae38a5bf60657e8af22a38000.
</footer>
</body>
</html>
